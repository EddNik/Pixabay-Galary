{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport '../css/styles.css';\n\nexport const iziToastOption = {\n  timeout: 5000,\n  theme: 'dark',\n  messageColor: 'white',\n  icon: 'custom-svg-icon',\n  iconColor: '#FFFFFF',\n  closeOnClick: true,\n  backgroundColor: '#ef4040',\n  position: 'topRight',\n};\n\nexport default async function getImagesByQuery(query, page) {\n  try {\n    const response = await axios.get('https://pixabay.com/api/', {\n      params: {\n        key: '51407519-422ec1314326ee48566ae1dd4',\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        per_page: 15,\n        page: page,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    console.log(error);\n    iziToastOption.message = `${error.message} : ${error.code}`;\n    iziToast.error(iziToastOption);\n    setTimeout(() => {\n      hideLoader();\n    }, 500);\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport '../../node_modules/simplelightbox/dist/simple-lightbox.min.css';\n\nexport const gallery = document.querySelector('.gallery');\nexport const btnLoader = document.querySelector('.load-more');\n\nconst simpleLightBox = new SimpleLightbox('.gallery a', {\n  captionDelay: 250,\n  overlayOpacity: 0.95,\n});\n\nexport async function createGallery(images) {\n  const listImages = images\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n            />\n          </a>\n          <div class=\"gallery-options-container\">\n          <div class=\"gallery-options\">\n            <h3 class=\"count-option\">Likes</h3>\n            <p>${likes}</p>\n          </div>\n          <div class=\"gallery-options\">\n            <h3 class=\"count-option\">Views</h3>\n            <p>${views}</p>\n          </div>\n          <div class=\"gallery-options\">\n            <h3 class=\"count-option\">Comments</h3>\n            <p>${comments}</p>\n          </div>\n          <div class=\"gallery-options\">\n            <h3 class=\"count-option\">Downloads</h3>\n            <p>${downloads}</p>\n          </div>\n         </div>\n        </li>`;\n      }\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', listImages);\n\n  simpleLightBox.refresh();\n}\n\nexport function showLoader(loader) {\n  loader.classList.add('loader');\n  loader.textContent = 'Loading';\n}\n\nexport function hideLoader(loader) {\n  loader.classList.remove('loader');\n  loader.textContent = '';\n}\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n\nexport function showLoadMoreButton() {\n  btnLoader.classList.remove('btn-loader');\n}\n\nexport function hideLoadMoreButton() {\n  btnLoader.classList.add('btn-loader');\n}\n","import getImagesByQuery from './js/pixabay-api';\nimport { iziToastOption } from './js/pixabay-api';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport * as render from './js/render-functions';\n\nconst form = document.querySelector('.form');\nconst page = {};\n\nconst loader = document.querySelector('.js-loader');\nconst loaderMore = document.querySelector('.js-loader-more');\n\nlet requestStatus = true;\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n  page.query = form.elements['search-text'].value.trim();\n\n  try {\n    if (!Boolean(page.query)) {\n      form.reset();\n      throw new Error('Sorry, this name images is empty. Please try again!');\n    }\n\n    // init page object : reset page number when entering a new search category OR when changing status request due to error\n    if (page.query !== page.previousQuery || !requestStatus) {\n      page.number = 1;\n      page.previousQuery = page.query;\n      requestStatus = true;\n    }\n    render.showLoader(loader);\n    const { totalHits, hits } = await getImagesByQuery(page.query, page.number);\n    page.total_pages = Math.ceil(totalHits / 15);\n\n    //Перевірка кінця колекції\n    if (page.number > page.total_pages) {\n      throw new Error('We are sorry, there are no more posts to load');\n    }\n\n    if (totalHits === 0) {\n      form.reset();\n      throw new Error(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n    } else {\n      render.clearGallery();\n      render.createGallery(hits);\n    }\n  } catch (error) {\n    iziToastErrorMessage(error);\n  }\n  render.hideLoader(loader);\n  render.showLoadMoreButton();\n});\n\nrender.btnLoader.addEventListener('click', async event => {\n  event.preventDefault();\n\n  page.number += 1;\n\n  try {\n    render.showLoader(loaderMore);\n    const { hits } = await getImagesByQuery(page.query, page.number);\n    render.createGallery(hits);\n    scroll();\n\n    //Перевірка кінця колекції\n    if (page.number >= page.total_pages || hits.length < 15) {\n      throw new Error('We are sorry, there are no more posts to load');\n    }\n  } catch (error) {\n    iziToastErrorMessage(error);\n  }\n  //лоадер приховується в самій помилці. Не зрозуміло зауваження : Це може спричинити залишення лоадера видимим, якщо після його приховання виникла помилка.\n  //але переніс ховання лоадера після помилки\n  render.hideLoader(loaderMore);\n});\n\nfunction iziToastErrorMessage(error) {\n  render.hideLoadMoreButton();\n  iziToastOption.message = error.message;\n  iziToast.show(iziToastOption);\n  // render.hideLoader(loader);\n  requestStatus = false;\n}\n\nfunction scroll() {\n  const galleryItem = render.gallery.lastChild;\n  const rect = galleryItem.getBoundingClientRect();\n  window.scrollBy(0, rect.height * 2);\n}\n\nform.reset();\n"],"names":["iziToastOption","getImagesByQuery","query","page","axios","error","iziToast","gallery","btnLoader","simpleLightBox","SimpleLightbox","createGallery","images","listImages","largeImageURL","webformatURL","tags","likes","views","comments","downloads","showLoader","loader","hideLoader","clearGallery","showLoadMoreButton","hideLoadMoreButton","form","loaderMore","requestStatus","event","render.showLoader","totalHits","hits","render.clearGallery","render.createGallery","iziToastErrorMessage","render.hideLoader","render.showLoadMoreButton","render.btnLoader","scroll","render.hideLoadMoreButton","rect","render.gallery"],"mappings":"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"}