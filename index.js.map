{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport '../css/styles.css';\n\nexport const iziToastOption = {\n  timeout: 5000,\n  theme: 'dark',\n  messageColor: 'white',\n  icon: 'custom-svg-icon',\n  iconColor: '#FFFFFF',\n  closeOnClick: true,\n  backgroundColor: '#ef4040',\n  position: 'topRight',\n};\n\nexport default async function getImagesByQuery(query, page) {\n  try {\n    const response = await axios.get('https://pixabay.com/api/', {\n      params: {\n        key: '51407519-422ec1314326ee48566ae1dd4',\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        per_page: 15,\n        page: page,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    console.log(error);\n    iziToastOption.message = `${error.message} : ${error.code}`;\n    iziToast.error(iziToastOption);\n    setTimeout(() => {\n      hideLoader();\n    }, 500);\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport '../../node_modules/simplelightbox/dist/simple-lightbox.min.css';\n\nexport const gallery = document.querySelector('.gallery');\nexport const btnLoader = document.querySelector('.load-more');\n\nexport async function createGallery(images) {\n  const listImages = images\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n            />\n          </a>\n          <div class=\"gallery-options-container\">\n          <div class=\"gallery-options\">\n            <h3 class=\"count-option\">Likes</h3>\n            <p>${likes}</p>\n          </div>\n          <div class=\"gallery-options\">\n            <h3 class=\"count-option\">Views</h3>\n            <p>${views}</p>\n          </div>\n          <div class=\"gallery-options\">\n            <h3 class=\"count-option\">Comments</h3>\n            <p>${comments}</p>\n          </div>\n          <div class=\"gallery-options\">\n            <h3 class=\"count-option\">Downloads</h3>\n            <p>${downloads}</p>\n          </div>\n         </div>\n        </li>`;\n      }\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', listImages);\n\n  new SimpleLightbox('.gallery a', {\n    captionDelay: 250,\n    overlayOpacity: 0.95,\n  }).refresh();\n}\n\nexport function showLoader(loader) {\n  loader.classList.add('loader');\n  loader.textContent = 'Loading';\n}\n\nexport function hideLoader(loader) {\n  loader.classList.remove('loader');\n  loader.textContent = '';\n}\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n\nexport function showLoadMoreButton() {\n  btnLoader.classList.remove('btn-loader');\n}\n\nexport function hideLoadMoreButton() {\n  btnLoader.classList.add('btn-loader');\n}\n","import getImagesByQuery from './js/pixabay-api';\nimport { iziToastOption } from './js/pixabay-api';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport * as render from './js/render-functions';\n\nconst form = document.querySelector('.form');\nconst page = {};\n\nconst loader = document.querySelector('.js-loader');\nconst loaderMore = document.querySelector('.js-loader-more');\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n  render.clearGallery();\n  page.query = form.elements['search-text'].value.trim();\n  render.showLoader(loader);\n\n  try {\n    if (!Boolean(page.query)) {\n      form.reset();\n      throw new Error('Sorry, this name images is empty. Please try again!');\n    }\n\n    // init page object : reset page number when entering a new search category OR when changing state due to error\n    if (page.query !== page.previousQuery || !page.state) {\n      page.number = 1;\n      page.previousQuery = page.query;\n      page.state = true;\n    }\n\n    const { totalHits, hits } = await getImagesByQuery(page.query, page.number);\n    total_pages = Math.ceil(totalHits / hits.length);\n\n    // just for testing the end of the collection: totalHits = 35\n    // page.total_pages = Math.ceil(35 / hits.length);\n\n    //Перевірка кінця колекції\n    if (page.number > page.total_pages) {\n      throw new Error('We are sorry, there are no more posts to load');\n    }\n\n    if (totalHits === 0) {\n      form.reset();\n      throw new Error(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n    } else {\n      render.createGallery(hits);\n      render.hideLoader(loader);\n      render.showLoadMoreButton();\n    }\n  } catch (error) {\n    iziToastErrorMessage(error, loader);\n  }\n});\n\nrender.btnLoader.addEventListener('click', async event => {\n  event.preventDefault();\n  render.showLoader(loaderMore);\n  page.number += 1;\n\n  try {\n    const { hits } = await getImagesByQuery(page.query, page.number);\n    render.createGallery(hits);\n    render.hideLoader(loaderMore);\n\n    //Перевірка кінця колекції\n    if (page.number === page.total_pages) {\n      throw new Error('We are sorry, there are no more posts to load');\n    }\n  } catch (error) {\n    iziToastErrorMessage(error, loaderMore);\n  }\n});\n\nfunction iziToastErrorMessage(error, loader) {\n  render.hideLoadMoreButton();\n  iziToastOption.message = error.message;\n  iziToast.show(iziToastOption);\n\n  // setTimeout is used only to improve visibility\n  setTimeout(() => {\n    render.hideLoader(loader);\n  }, 500);\n  page.state = false;\n}\n\nform.reset();\n"],"names":["iziToastOption","getImagesByQuery","query","page","axios","error","iziToast","gallery","btnLoader","createGallery","images","listImages","largeImageURL","webformatURL","tags","likes","views","comments","downloads","SimpleLightbox","showLoader","loader","hideLoader","clearGallery","showLoadMoreButton","hideLoadMoreButton","form","loaderMore","event","render.clearGallery","render.showLoader","totalHits","hits","render.createGallery","render.hideLoader","render.showLoadMoreButton","iziToastErrorMessage","render.btnLoader","render.hideLoadMoreButton"],"mappings":"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"}